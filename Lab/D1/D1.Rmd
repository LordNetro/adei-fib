#The data for the project comes in a csv file:

```{r Read data}
bmw <- read.csv("bmw.csv")
```

#Once we have our data read, we can save it as an RData file, which will be very easy to save and load:

```{r Save data}
save(bmw, file = "bmw.RData")
```

#If we want to load it, we only need to use `load`:

```{r Load data}
load("bmw.RData")
```

#We can transform variables into factors with `as.factor`:

```{r}
factormpg <- as.factor(bmw$mpg)
testVar <- as.factor(bmw$transmission)
summary(testVar)
```
```{r}
as.factor(bmw$mpg)
```

#Price Histogram

```{r}
hist(bmw$price, main="Price Histogram", xlab="Price", col="skyblue", border="black")
```
#Transmission Barplot

```{r}
barplot(table(bmw$transmission), main="Barplot of Transmission Types", xlab="Transmission Type", ylab="Frequency", col=c("skyblue", "lightpink"), border="black")

```
#Barplot of Fuel Types

```{r}
barplot(table(bmw$fuelType), main="Barplot of Fuel Types", xlab="Fuel Type", ylab="Frequency", col=c("skyblue", "lightpink", "lightgreen"), border="black")
```
#MPG Histogram

```{r}
hist(bmw$mpg, main="MPG Histogram", xlab="MPG", col="skyblue", border="black")
```
#Mileage Histogram

```{r}
hist(bmw$mileage, main="Mileage Histogram", xlab="Mileage", col="lightgreen", border="black")
```
#Model Barplot

```{r}
barplot(table(bmw$model), main="Barplot of BMW Models", xlab="Model", ylab="Frequency", col=rainbow(length(table(bmw$model))), border="black")
```
#Year Barplot

```{r}
barplot(table(bmw$year), main="Barplot of Year", xlab="Year", ylab="Frequency", col=rainbow(length(table(bmw$year))), border="black")
```
#Tax Histogram

```{r}
hist(bmw$tax, main="Tax Histogram", xlab = "Tax", col = "lightyellow", border = "black")
```
#Engine Size Histogram

```{r}
hist(bmw$engineSize, main="Engine Size Histogram", xlab = "Engine Size", col = "lightcoral", border = "black")
```
```{r}
summary(bmw)
```

#Engine Size Histogram

```{r}
hist(bmw$engineSize, main="Engine Size Histogram", xlab = "Engine Size", col = "lightcoral", border = "black")
```
#Factorized Model Histogram

```{r}
factorModel <- as.factor(bmw$model)
summary(factorModel)
plot(factorModel, main="Factorized Engine Size Histogram",  col = rainbow(24))
```
#Factorized Fuel Type Histogram

```{r}
factorModel <- as.factor(bmw$model)
summary(factorModel)
plot(factorModel, main="Factorized Engine Size Histogram",  col = rainbow(24))
```

## Some useful functions

```{r, echo=FALSE}

# Some useful functions
calcQ <- function(x) {
  s.x <- summary(x)
  iqr<-s.x[5]-s.x[2]
  list(souti=s.x[2]-3*iqr, mouti=s.x[2]-1.5*iqr, min=s.x[1], q1=s.x[2], q2=s.x[3], 
       q3=s.x[5], max=s.x[6], mouts=s.x[5]+1.5*iqr, souts=s.x[5]+3*iqr ) }

countNA <- function(x) {
  mis_x <- NULL
  for (j in 1:ncol(x)) {mis_x[j] <- sum(is.na(x[,j])) }
  mis_x <- as.data.frame(mis_x)
  rownames(mis_x) <- names(x)
  mis_i <- rep(0,nrow(x))
  for (j in 1:ncol(x)) {mis_i <- mis_i + as.numeric(is.na(x[,j])) }
  list(mis_col=mis_x,mis_ind=mis_i) }

countX <- function(x,X) {
  n_x <- NULL
  for (j in 1:ncol(x)) {n_x[j] <- sum(x[,j]==X) }
  n_x <- as.data.frame(n_x)
  rownames(n_x) <- names(x)
  nx_i <- rep(0,nrow(x))
  for (j in 1:ncol(x)) {nx_i <- nx_i + as.numeric(x[,j]==X) }
  list(nx_col=n_x,nx_ind=nx_i) }

```

# Initialization of counts for missings, outliers and errors. All numerical variables have to be checked before and processing of outliers and errors
```{r}

bmwVariables <- data.frame(price = bmw$price, engineSize = bmw$engineSize)


#######################################################
imis<-rep(0,nrow(bmwVariables))  # rows - trips
jmis<-rep(0,ncol(bmwVariables))  # columns - variables
######################################################
mis1<-countNA(bmwVariables)
imis<-mis1$mis_ind
mis1$mis_col # Number of missings for the current set of variables

#######################################################
iouts<-rep(0,nrow(bmwVariables))  # rows - trips
jouts<-rep(0,ncol(bmwVariables))  # columns - variables
######################################################

#######################################################
ierrs<-rep(0,nrow(bmwVariables))  # rows - trips
jerrs<-rep(0,ncol(bmwVariables))  # columns - variables
######################################################

bmwVariables[which(bmwVariables[,"engineSize"]==0),]

# EngineSize
# It is a quantitive variable  Non-possible values will be recoded to NA
selEngine<-which(bmwVariables$engineSize ==0)
ierrs[selEngine]<-ierrs[selEngine]+1
jerrs[2]<-length(selEngine)
selEngine                 #### sel contains the rownames of the individuals with "0" 
#                        as  value for engineSize
# df[sel,"engineSize"]<-3    # non-possible values are replaced by NA, missing value symbol in R
bmwVariables[selEngine,"engineSize"]<-NA
selmissEngine <- selEngine

# Price
# It is a quantitive variable  Non-possible values will be recoded to NA
selPrice<-which(bmwVariables$price <=0)
ierrs[selPrice]<-ierrs[selPrice]+1
jerrs[1]<-length(selPrice)
selPrice                 #### sel contains the rownames of the individuals with "0" 
#                        as  value for engineSize
# df[sel,"engineSize"]<-3    # non-possible values are replaced by NA, missing value symbol in R
bmwVariables[selPrice,"price"]<-NA
selmissPrice <- selPrice

summary(bmwVariables$engineSize)
summary(bmwVariables$price)
ierrs
jerrs

```